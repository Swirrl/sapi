# Test of description and nesting with explicit query
type : list

prefixes : 
  rdf :  "http://www.w3.org/1999/02/22-rdf-syntax-ns#"
  rdfs : "http://www.w3.org/2000/01/rdf-schema#"
  rt :   "http://environment.data.gov.uk/flood-monitoring/def/core/"
  dct:   "http://purl.org/dc/terms/"
  skos:  "http://www.w3.org/2004/02/skos/core#"

# baseQuery : "?id a rt:FloodAlertOrWarning ."

query: >
    PREFIX rt: <http://environment.data.gov.uk/flood-monitoring/def/core/>
    PREFIX skos: <http://www.w3.org/2004/02/skos/core#>
    SELECT * WHERE {
        ?id a rt:FloodAlertOrWarning ;
            rt:severity ?severity ;
            rt:severityLevel ?severityLevel ;
            rt:floodArea ?floodArea ;
        .
        FILTER (?severityLevel  <= ?min-severity)
        OPTIONAL {?id rt:message ?message}
        ?floodArea
            rt:county ?county ;
            skos:notation ?notation ;
            rt:riverOrSea ?riverOrSea ;
            rt:polygon ?polygon ;
            .
       }

mapping :
  - "rt:severity"
  - "rt:severityLevel"
  - { prop : "rt:message", optional : true }
  - { prop : "rt:messageWelsh", optional : true }
  - prop : "rt:floodArea"
    nested :
      - "skos:notation"
      - "rt:county"
      - "rt:riverOrSea"
      - "rt:polygon"
  - "rt:eaAreaName"
  - "rt:eaRegionName"
  - "dct:description"
  - "rt:isTidal"
  - "rt:timeMessageChanged"
  - "rt:timeRaised"
  - "rt:timeSeverityChanged"
